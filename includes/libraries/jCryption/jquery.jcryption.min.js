function setMaxDigits(e){maxDigits=e;ZERO_ARRAY=new Array(maxDigits);for(var t=0;t<ZERO_ARRAY.length;t++)ZERO_ARRAY[t]=0;bigZero=new BigInt;bigOne=new BigInt;bigOne.digits[0]=1}function BigInt(e){if(typeof e=="boolean"&&e==true){this.digits=null}else{this.digits=ZERO_ARRAY.slice(0)}this.isNeg=false}function biFromDecimal(e){var t=e.charAt(0)=="-";var n=t?1:0;var r;while(n<e.length&&e.charAt(n)=="0")++n;if(n==e.length){r=new BigInt}else{var i=e.length-n;var s=i%dpl10;if(s==0)s=dpl10;r=biFromNumber(Number(e.substr(n,s)));n+=s;while(n<e.length){r=biAdd(biMultiply(r,biFromNumber(1e15)),biFromNumber(Number(e.substr(n,dpl10))));n+=dpl10}r.isNeg=t}return r}function biCopy(e){var t=new BigInt(true);t.digits=e.digits.slice(0);t.isNeg=e.isNeg;return t}function biFromNumber(e){var t=new BigInt;t.isNeg=e<0;e=Math.abs(e);var n=0;while(e>0){t.digits[n++]=e&maxDigitVal;e>>=biRadixBits}return t}function reverseStr(e){var t="";for(var n=e.length-1;n>-1;--n){t+=e.charAt(n)}return t}function biToString(e,t){var n=new BigInt;n.digits[0]=t;var r=biDivideModulo(e,n);var i=hexatrigesimalToChar[r[1].digits[0]];while(biCompare(r[0],bigZero)==1){r=biDivideModulo(r[0],n);digit=r[1].digits[0];i+=hexatrigesimalToChar[r[1].digits[0]]}return(e.isNeg?"-":"")+reverseStr(i)}function biToDecimal(e){var t=new BigInt;t.digits[0]=10;var n=biDivideModulo(e,t);var r=String(n[1].digits[0]);while(biCompare(n[0],bigZero)==1){n=biDivideModulo(n[0],t);r+=String(n[1].digits[0])}return(e.isNeg?"-":"")+reverseStr(r)}function digitToHex(e){var t=15;var n="";for(i=0;i<4;++i){n+=hexToChar[e&t];e>>>=4}return reverseStr(n)}function biToHex(e){var t="";var n=biHighIndex(e);for(var r=biHighIndex(e);r>-1;--r){t+=digitToHex(e.digits[r])}return t}function charToHex(e){var t=48;var n=t+9;var r=97;var i=r+25;var s=65;var o=65+25;var u;if(e>=t&&e<=n){u=e-t}else if(e>=s&&e<=o){u=10+e-s}else if(e>=r&&e<=i){u=10+e-r}else{u=0}return u}function hexToDigit(e){var t=0;var n=Math.min(e.length,4);for(var r=0;r<n;++r){t<<=4;t|=charToHex(e.charCodeAt(r))}return t}function biFromHex(e){var t=new BigInt;var n=e.length;for(var r=n,i=0;r>0;r-=4,++i){t.digits[i]=hexToDigit(e.substr(Math.max(r-4,0),Math.min(r,4)))}return t}function biFromString(e,t){var n=e.charAt(0)=="-";var r=n?1:0;var i=new BigInt;var s=new BigInt;s.digits[0]=1;for(var o=e.length-1;o>=r;o--){var u=e.charCodeAt(o);var a=charToHex(u);var f=biMultiplyDigit(s,a);i=biAdd(i,f);s=biMultiplyDigit(s,t)}i.isNeg=n;return i}function biDump(e){return(e.isNeg?"-":"")+e.digits.join(" ")}function biAdd(e,t){var n;if(e.isNeg!=t.isNeg){t.isNeg=!t.isNeg;n=biSubtract(e,t);t.isNeg=!t.isNeg}else{n=new BigInt;var r=0;var i;for(var s=0;s<e.digits.length;++s){i=e.digits[s]+t.digits[s]+r;n.digits[s]=i&65535;r=Number(i>=biRadix)}n.isNeg=e.isNeg}return n}function biSubtract(e,t){var n;if(e.isNeg!=t.isNeg){t.isNeg=!t.isNeg;n=biAdd(e,t);t.isNeg=!t.isNeg}else{n=new BigInt;var r,i;i=0;for(var s=0;s<e.digits.length;++s){r=e.digits[s]-t.digits[s]+i;n.digits[s]=r&65535;if(n.digits[s]<0)n.digits[s]+=biRadix;i=0-Number(r<0)}if(i==-1){i=0;for(var s=0;s<e.digits.length;++s){r=0-n.digits[s]+i;n.digits[s]=r&65535;if(n.digits[s]<0)n.digits[s]+=biRadix;i=0-Number(r<0)}n.isNeg=!e.isNeg}else{n.isNeg=e.isNeg}}return n}function biHighIndex(e){var t=e.digits.length-1;while(t>0&&e.digits[t]==0)--t;return t}function biNumBits(e){var t=biHighIndex(e);var n=e.digits[t];var r=(t+1)*bitsPerDigit;var i;for(i=r;i>r-bitsPerDigit;--i){if((n&32768)!=0)break;n<<=1}return i}function biMultiply(e,t){var n=new BigInt;var r;var i=biHighIndex(e);var s=biHighIndex(t);var o,u,a;for(var f=0;f<=s;++f){r=0;a=f;for(j=0;j<=i;++j,++a){u=n.digits[a]+e.digits[j]*t.digits[f]+r;n.digits[a]=u&maxDigitVal;r=u>>>biRadixBits}n.digits[f+i+1]=r}n.isNeg=e.isNeg!=t.isNeg;return n}function biMultiplyDigit(e,t){var n,r,i;var s=new BigInt;n=biHighIndex(e);r=0;for(var o=0;o<=n;++o){i=s.digits[o]+e.digits[o]*t+r;s.digits[o]=i&maxDigitVal;r=i>>>biRadixBits}s.digits[1+n]=r;return s}function arrayCopy(e,t,n,r,i){var s=Math.min(t+i,e.length);for(var o=t,u=r;o<s;++o,++u){n[u]=e[o]}}function biShiftLeft(e,t){var n=Math.floor(t/bitsPerDigit);var r=new BigInt;arrayCopy(e.digits,0,r.digits,n,r.digits.length-n);var i=t%bitsPerDigit;var s=bitsPerDigit-i;for(var o=r.digits.length-1,u=o-1;o>0;--o,--u){r.digits[o]=r.digits[o]<<i&maxDigitVal|(r.digits[u]&highBitMasks[i])>>>s}r.digits[0]=r.digits[o]<<i&maxDigitVal;r.isNeg=e.isNeg;return r}function biShiftRight(e,t){var n=Math.floor(t/bitsPerDigit);var r=new BigInt;arrayCopy(e.digits,n,r.digits,0,e.digits.length-n);var i=t%bitsPerDigit;var s=bitsPerDigit-i;for(var o=0,u=o+1;o<r.digits.length-1;++o,++u){r.digits[o]=r.digits[o]>>>i|(r.digits[u]&lowBitMasks[i])<<s}r.digits[r.digits.length-1]>>>=i;r.isNeg=e.isNeg;return r}function biMultiplyByRadixPower(e,t){var n=new BigInt;arrayCopy(e.digits,0,n.digits,t,n.digits.length-t);return n}function biDivideByRadixPower(e,t){var n=new BigInt;arrayCopy(e.digits,t,n.digits,0,n.digits.length-t);return n}function biModuloByRadixPower(e,t){var n=new BigInt;arrayCopy(e.digits,0,n.digits,0,t);return n}function biCompare(e,t){if(e.isNeg!=t.isNeg){return 1-2*Number(e.isNeg)}for(var n=e.digits.length-1;n>=0;--n){if(e.digits[n]!=t.digits[n]){if(e.isNeg){return 1-2*Number(e.digits[n]>t.digits[n])}else{return 1-2*Number(e.digits[n]<t.digits[n])}}}return 0}function biDivideModulo(e,t){var n=biNumBits(e);var r=biNumBits(t);var i=t.isNeg;var s,o;if(n<r){if(e.isNeg){s=biCopy(bigOne);s.isNeg=!t.isNeg;e.isNeg=false;t.isNeg=false;o=biSubtract(t,e);e.isNeg=true;t.isNeg=i}else{s=new BigInt;o=biCopy(e)}return new Array(s,o)}s=new BigInt;o=e;var u=Math.ceil(r/bitsPerDigit)-1;var a=0;while(t.digits[u]<biHalfRadix){t=biShiftLeft(t,1);++a;++r;u=Math.ceil(r/bitsPerDigit)-1}o=biShiftLeft(o,a);n+=a;var f=Math.ceil(n/bitsPerDigit)-1;var l=biMultiplyByRadixPower(t,f-u);while(biCompare(o,l)!=-1){++s.digits[f-u];o=biSubtract(o,l)}for(var c=f;c>u;--c){var h=c>=o.digits.length?0:o.digits[c];var p=c-1>=o.digits.length?0:o.digits[c-1];var d=c-2>=o.digits.length?0:o.digits[c-2];var v=u>=t.digits.length?0:t.digits[u];var m=u-1>=t.digits.length?0:t.digits[u-1];if(h==v){s.digits[c-u-1]=maxDigitVal}else{s.digits[c-u-1]=Math.floor((h*biRadix+p)/v)}var g=s.digits[c-u-1]*(v*biRadix+m);var y=h*biRadixSquared+(p*biRadix+d);while(g>y){--s.digits[c-u-1];g=s.digits[c-u-1]*(v*biRadix|m);y=h*biRadix*biRadix+(p*biRadix+d)}l=biMultiplyByRadixPower(t,c-u-1);o=biSubtract(o,biMultiplyDigit(l,s.digits[c-u-1]));if(o.isNeg){o=biAdd(o,l);--s.digits[c-u-1]}}o=biShiftRight(o,a);s.isNeg=e.isNeg!=i;if(e.isNeg){if(i){s=biAdd(s,bigOne)}else{s=biSubtract(s,bigOne)}t=biShiftRight(t,a);o=biSubtract(t,o)}if(o.digits[0]==0&&biHighIndex(o)==0)o.isNeg=false;return new Array(s,o)}function biDivide(e,t){return biDivideModulo(e,t)[0]}function biModulo(e,t){return biDivideModulo(e,t)[1]}function biMultiplyMod(e,t,n){return biModulo(biMultiply(e,t),n)}function biPow(e,t){var n=bigOne;var r=e;while(true){if((t&1)!=0)n=biMultiply(n,r);t>>=1;if(t==0)break;r=biMultiply(r,r)}return n}function biPowMod(e,t,n){var r=bigOne;var i=e;var s=t;while(true){if((s.digits[0]&1)!=0)r=biMultiplyMod(r,i,n);s=biShiftRight(s,1);if(s.digits[0]==0&&biHighIndex(s)==0)break;i=biMultiplyMod(i,i,n)}return r}function BarrettMu(e){this.modulus=biCopy(e);this.k=biHighIndex(this.modulus)+1;var t=new BigInt;t.digits[2*this.k]=1;this.mu=biDivide(t,this.modulus);this.bkplus1=new BigInt;this.bkplus1.digits[this.k+1]=1;this.modulo=BarrettMu_modulo;this.multiplyMod=BarrettMu_multiplyMod;this.powMod=BarrettMu_powMod}function BarrettMu_modulo(e){var t=biDivideByRadixPower(e,this.k-1);var n=biMultiply(t,this.mu);var r=biDivideByRadixPower(n,this.k+1);var i=biModuloByRadixPower(e,this.k+1);var s=biMultiply(r,this.modulus);var o=biModuloByRadixPower(s,this.k+1);var u=biSubtract(i,o);if(u.isNeg){u=biAdd(u,this.bkplus1)}var a=biCompare(u,this.modulus)>=0;while(a){u=biSubtract(u,this.modulus);a=biCompare(u,this.modulus)>=0}return u}function BarrettMu_multiplyMod(e,t){var n=biMultiply(e,t);return this.modulo(n)}function BarrettMu_powMod(e,t){var n=new BigInt;n.digits[0]=1;while(true){if((t.digits[0]&1)!=0)n=this.multiplyMod(n,e);t=biShiftRight(t,1);if(t.digits[0]==0&&biHighIndex(t)==0)break;e=this.multiplyMod(e,e)}return n}(function(e){e.jCryption=function(t,n){var r=this;r.$el=e(t);r.el=t;r.$el.data("jCryption",r);r.$el.data("salt",null);r.$el.data("key",null);r.init=function(){r.options=e.extend({},e.jCryption.defaultOptions,n);r.$el.bind("mousemove",function(e){if(r.$el.data("salt")===null){r.$el.data("salt",(e.pageX+e.pageY)*Math.random())}else{r.$el.unbind("mousemove")}});$encryptedElement=e("<input />",{type:"hidden",name:r.options.postVariable});if(r.options.submitElement!==false){var t=r.options.submitElement}else{var t=r.$el.find(":input:submit")}t.bind(r.options.submitEvent,function(){e(this).attr("disabled",true);if(r.options.beforeEncryption()){r.authenticate(function(n){var i=r.$el.serialize();if(t.is(":submit")){i=i+"&"+t.attr("name")+"="+t.val()}$encryptedElement.val(e.jCryption.encrypt(i,n));e(r.$el).find(r.options.formFieldSelector).attr("disabled",true).end().append($encryptedElement).submit()},function(){e(r.$el).submit()})}return false})};r.init();r.getKey=function(){if(r.$el.data("key")!==null){return r.$el.data("key")}var e=r.$el.data("salt");if(e===null){e=Math.floor(Math.random()*Math.random())}var t=new jsSHA(e.toString(),"ASCII");r.$el.data("key",t.getHash("SHA-512","HEX"));return r.getKey()};r.authenticate=function(t,n){var i=r.getKey();e.jCryption.authenticate(i,r.options.getKeysURL,r.options.handshakeURL,t,n)}};e.jCryption.authenticate=function(t,n,r,i,s){e.jCryption.getKeys(n,function(n){e.jCryption.encryptKey(t,n,function(n){e.jCryption.handshake(r,n,function(n){if(e.jCryption.challenge(n.challenge,t)){i.call(this,t)}else{s.call(this)}})})})};e.jCryption.getKeys=function(t,n){var r=function(e,t,n){setMaxDigits(parseInt(n,10));this.e=biFromHex(e);this.m=biFromHex(t);this.chunkSize=2*biHighIndex(this.m);this.radix=16;this.barrett=new BarrettMu(this.m)};e.getJSON(t,function(t){if(t.e=="encryption_cfg_error"){e("#channel_status").html(t.msg)}else{var i=new r(t.e,t.n,t.maxdigits);if(e.isFunction(n)){n.call(this,i)}}})};e.jCryption.decrypt=function(e,t){return Aes.Ctr.decrypt(e,t,256)};e.jCryption.encrypt=function(e,t){return Aes.Ctr.encrypt(e,t,256)};e.jCryption.challenge=function(t,n){if(e.jCryption.decrypt(t,n)==n){return true}return false};e.jCryption.handshake=function(t,n,r){e.ajax({url:t,dataType:"json",type:"POST",data:{key:n},success:function(e){r.call(this,e)}})};e.jCryption.encryptKey=function(t,n,r){function c(t){function a(){o=new BigInt;s=0;for(var f=i;f<i+n.chunkSize;++s){o.digits[s]=t[f++];o.digits[s]+=t[f++]<<8}var l=n.barrett.powMod(o,n.e);var c=n.radix==16?biToHex(l):biToString(l,n.radix);u+=c+" ";i+=n.chunkSize;if(i<t.length){setTimeout(a,1)}else{var h=u.substring(0,u.length-1);if(e.isFunction(r)){r(h)}else{return h}}}var i=0;var s,o;var u="";setTimeout(a,1)}var i=0;for(var s=0;s<t.length;s++){i+=t.charCodeAt(s)}var o="0123456789abcdef";var u="";u+=o.charAt((i&240)>>4)+o.charAt(i&15);var a=u+t;var f=[];var l=0;while(l<a.length){f[l]=a.charCodeAt(l);l++}while(f.length%n.chunkSize!==0){f[l++]=0}c(f)};e.jCryption.defaultOptions={submitElement:false,submitEvent:"click",getKeysURL:"main.php?generateKeypair=true",handshakeURL:"main.php?handshake=true",beforeEncryption:function(){return true},postVariable:"jCryption",formFieldSelector:":input"};e.fn.jCryption=function(t){return this.each(function(){new e.jCryption(this,t)})}})(jQuery);var biRadixBase=2;var biRadixBits=16;var bitsPerDigit=biRadixBits;var biRadix=1<<16;var biHalfRadix=biRadix>>>1;var biRadixSquared=biRadix*biRadix;var maxDigitVal=biRadix-1;var maxInteger=9999999999999998;var maxDigits;var ZERO_ARRAY;var bigZero,bigOne;var dpl10=15;var highBitMasks=new Array(0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535);var hexatrigesimalToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z");var hexToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");var lowBitMasks=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535);var Aes={};Aes.cipher=function(e,t){var n=4;var r=t.length/n-1;var i=[[],[],[],[]];for(var s=0;s<4*n;s++)i[s%4][Math.floor(s/4)]=e[s];i=Aes.addRoundKey(i,t,0,n);for(var o=1;o<r;o++){i=Aes.subBytes(i,n);i=Aes.shiftRows(i,n);i=Aes.mixColumns(i,n);i=Aes.addRoundKey(i,t,o,n)}i=Aes.subBytes(i,n);i=Aes.shiftRows(i,n);i=Aes.addRoundKey(i,t,r,n);var u=new Array(4*n);for(var s=0;s<4*n;s++)u[s]=i[s%4][Math.floor(s/4)];return u};Aes.keyExpansion=function(e){var t=4;var n=e.length/4;var r=n+6;var i=new Array(t*(r+1));var s=new Array(4);for(var o=0;o<n;o++){var u=[e[4*o],e[4*o+1],e[4*o+2],e[4*o+3]];i[o]=u}for(var o=n;o<t*(r+1);o++){i[o]=new Array(4);for(var a=0;a<4;a++)s[a]=i[o-1][a];if(o%n==0){s=Aes.subWord(Aes.rotWord(s));for(var a=0;a<4;a++)s[a]^=Aes.rCon[o/n][a]}else if(n>6&&o%n==4){s=Aes.subWord(s)}for(var a=0;a<4;a++)i[o][a]=i[o-n][a]^s[a]}return i};Aes.subBytes=function(e,t){for(var n=0;n<4;n++){for(var r=0;r<t;r++)e[n][r]=Aes.sBox[e[n][r]]}return e};Aes.shiftRows=function(e,t){var n=new Array(4);for(var r=1;r<4;r++){for(var i=0;i<4;i++)n[i]=e[r][(i+r)%t];for(var i=0;i<4;i++)e[r][i]=n[i]}return e};Aes.mixColumns=function(e,t){for(var n=0;n<4;n++){var r=new Array(4);var i=new Array(4);for(var s=0;s<4;s++){r[s]=e[s][n];i[s]=e[s][n]&128?e[s][n]<<1^283:e[s][n]<<1}e[0][n]=i[0]^r[1]^i[1]^r[2]^r[3];e[1][n]=r[0]^i[1]^r[2]^i[2]^r[3];e[2][n]=r[0]^r[1]^i[2]^r[3]^i[3];e[3][n]=r[0]^i[0]^r[1]^r[2]^i[3]}return e};Aes.addRoundKey=function(e,t,n,r){for(var i=0;i<4;i++){for(var s=0;s<r;s++)e[i][s]^=t[n*4+s][i]}return e};Aes.subWord=function(e){for(var t=0;t<4;t++)e[t]=Aes.sBox[e[t]];return e};Aes.rotWord=function(e){var t=e[0];for(var n=0;n<3;n++)e[n]=e[n+1];e[3]=t;return e};Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];Aes.Ctr={};Aes.Ctr.encrypt=function(e,t,n){var r=16;if(!(n==128||n==192||n==256))return"";e=Utf8.encode(e);t=Utf8.encode(t);var i=n/8;var s=new Array(i);for(var o=0;o<i;o++){s[o]=isNaN(t.charCodeAt(o))?0:t.charCodeAt(o)}var u=Aes.cipher(s,Aes.keyExpansion(s));u=u.concat(u.slice(0,i-16));var a=new Array(r);var f=(new Date).getTime();var l=f%1e3;var c=Math.floor(f/1e3);var h=Math.floor(Math.random()*65535);for(var o=0;o<2;o++)a[o]=l>>>o*8&255;for(var o=0;o<2;o++)a[o+2]=h>>>o*8&255;for(var o=0;o<4;o++)a[o+4]=c>>>o*8&255;var p="";for(var o=0;o<8;o++)p+=String.fromCharCode(a[o]);var d=Aes.keyExpansion(u);var v=Math.ceil(e.length/r);var m=new Array(v);for(var g=0;g<v;g++){for(var y=0;y<4;y++)a[15-y]=g>>>y*8&255;for(var y=0;y<4;y++)a[15-y-4]=g/4294967296>>>y*8;var b=Aes.cipher(a,d);var w=g<v-1?r:(e.length-1)%r+1;var E=new Array(w);for(var o=0;o<w;o++){E[o]=b[o]^e.charCodeAt(g*r+o);E[o]=String.fromCharCode(E[o])}m[g]=E.join("")}var S=p+m.join("");S=Base64.encode(S);return S};Aes.Ctr.decrypt=function(e,t,n){var r=16;if(!(n==128||n==192||n==256))return"";e=Base64.decode(e);t=Utf8.encode(t);var i=n/8;var s=new Array(i);for(var o=0;o<i;o++){s[o]=isNaN(t.charCodeAt(o))?0:t.charCodeAt(o)}var u=Aes.cipher(s,Aes.keyExpansion(s));u=u.concat(u.slice(0,i-16));var a=new Array(8);ctrTxt=e.slice(0,8);for(var o=0;o<8;o++)a[o]=ctrTxt.charCodeAt(o);var f=Aes.keyExpansion(u);var l=Math.ceil((e.length-8)/r);var c=new Array(l);for(var h=0;h<l;h++)c[h]=e.slice(8+h*r,8+h*r+r);e=c;var p=new Array(e.length);for(var h=0;h<l;h++){for(var d=0;d<4;d++)a[15-d]=h>>>d*8&255;for(var d=0;d<4;d++)a[15-d-4]=(h+1)/4294967296-1>>>d*8&255;var v=Aes.cipher(a,f);var m=new Array(e[h].length);for(var o=0;o<e[h].length;o++){m[o]=v[o]^e[h].charCodeAt(o);m[o]=String.fromCharCode(m[o])}p[h]=m.join("")}var g=p.join("");g=Utf8.decode(g);return g};var Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Base64.encode=function(e,t){t=typeof t=="undefined"?false:t;var n,r,i,s,o,u,a,f,l=[],c="",h,p,d;var v=Base64.code;p=t?e.encodeUTF8():e;h=p.length%3;if(h>0){while(h++<3){c+="=";p+="\0"}}for(h=0;h<p.length;h+=3){n=p.charCodeAt(h);r=p.charCodeAt(h+1);i=p.charCodeAt(h+2);s=n<<16|r<<8|i;o=s>>18&63;u=s>>12&63;a=s>>6&63;f=s&63;l[h/3]=v.charAt(o)+v.charAt(u)+v.charAt(a)+v.charAt(f)}d=l.join("");d=d.slice(0,d.length-c.length)+c;return d};Base64.decode=function(e,t){t=typeof t=="undefined"?false:t;var n,r,i,s,o,u,a,f,l=[],c,h;var p=Base64.code;h=t?e.decodeUTF8():e;for(var d=0;d<h.length;d+=4){s=p.indexOf(h.charAt(d));o=p.indexOf(h.charAt(d+1));u=p.indexOf(h.charAt(d+2));a=p.indexOf(h.charAt(d+3));f=s<<18|o<<12|u<<6|a;n=f>>>16&255;r=f>>>8&255;i=f&255;l[d/4]=String.fromCharCode(n,r,i);if(a==64)l[d/4]=String.fromCharCode(n,r);if(u==64)l[d/4]=String.fromCharCode(n)}c=l.join("");return t?c.decodeUTF8():c};var Utf8={};Utf8.encode=function(e){var t=e.replace(/[\u0080-\u07ff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(192|t>>6,128|t&63)});t=t.replace(/[\u0800-\uffff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(224|t>>12,128|t>>6&63,128|t&63)});return t};Utf8.decode=function(e){var t=e.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var t=(e.charCodeAt(0)&15)<<12|(e.charCodeAt(1)&63)<<6|e.charCodeAt(2)&63;return String.fromCharCode(t)});t=t.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var t=(e.charCodeAt(0)&31)<<6|e.charCodeAt(1)&63;return String.fromCharCode(t)});return t};var charSize=8,b64pad="",hexCase=0,Int_64=function(e,t){this.highOrder=e;this.lowOrder=t},str2binb=function(e){var t=[],n=(1<<charSize)-1,r=e.length*charSize,i;for(i=0;i<r;i+=charSize){t[i>>5]|=(e.charCodeAt(i/charSize)&n)<<32-charSize-i%32}return t},hex2binb=function(e){var t=[],n=e.length,r,i;for(r=0;r<n;r+=2){i=parseInt(e.substr(r,2),16);if(!isNaN(i)){t[r>>3]|=i<<24-4*(r%8)}else{return"INVALID HEX STRING"}}return t},binb2hex=function(e){var t=hexCase?"0123456789ABCDEF":"0123456789abcdef",n="",r=e.length*4,i,s;for(i=0;i<r;i+=1){s=e[i>>2]>>(3-i%4)*8;n+=t.charAt(s>>4&15)+t.charAt(s&15)}return n},binb2b64=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"+"0123456789+/",n="",r=e.length*4,i,s,o;for(i=0;i<r;i+=3){o=(e[i>>2]>>8*(3-i%4)&255)<<16|(e[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|e[i+2>>2]>>8*(3-(i+2)%4)&255;for(s=0;s<4;s+=1){if(i*8+s*6<=e.length*32){n+=t.charAt(o>>6*(3-s)&63)}else{n+=b64pad}}}return n},rotl_32=function(e,t){return e<<t|e>>>32-t},rotr_32=function(e,t){return e>>>t|e<<32-t},rotr_64=function(e,t){if(t<=32){return new Int_64(e.highOrder>>>t|e.lowOrder<<32-t,e.lowOrder>>>t|e.highOrder<<32-t)}else{return new Int_64(e.lowOrder>>>t|e.highOrder<<32-t,e.highOrder>>>t|e.lowOrder<<32-t)}},shr_32=function(e,t){return e>>>t},shr_64=function(e,t){if(t<=32){return new Int_64(e.highOrder>>>t,e.lowOrder>>>t|e.highOrder<<32-t)}else{return new Int_64(0,e.highOrder<<32-t)}},parity_32=function(e,t,n){return e^t^n},ch_32=function(e,t,n){return e&t^~e&n},ch_64=function(e,t,n){return new Int_64(e.highOrder&t.highOrder^~e.highOrder&n.highOrder,e.lowOrder&t.lowOrder^~e.lowOrder&n.lowOrder)},maj_32=function(e,t,n){return e&t^e&n^t&n},maj_64=function(e,t,n){return new Int_64(e.highOrder&t.highOrder^e.highOrder&n.highOrder^t.highOrder&n.highOrder,e.lowOrder&t.lowOrder^e.lowOrder&n.lowOrder^t.lowOrder&n.lowOrder)},sigma0_32=function(e){return rotr_32(e,2)^rotr_32(e,13)^rotr_32(e,22)},sigma0_64=function(e){var t=rotr_64(e,28),n=rotr_64(e,34),r=rotr_64(e,39);return new Int_64(t.highOrder^n.highOrder^r.highOrder,t.lowOrder^n.lowOrder^r.lowOrder)},sigma1_32=function(e){return rotr_32(e,6)^rotr_32(e,11)^rotr_32(e,25)},sigma1_64=function(e){var t=rotr_64(e,14),n=rotr_64(e,18),r=rotr_64(e,41);return new Int_64(t.highOrder^n.highOrder^r.highOrder,t.lowOrder^n.lowOrder^r.lowOrder)},gamma0_32=function(e){return rotr_32(e,7)^rotr_32(e,18)^shr_32(e,3)},gamma0_64=function(e){var t=rotr_64(e,1),n=rotr_64(e,8),r=shr_64(e,7);return new Int_64(t.highOrder^n.highOrder^r.highOrder,t.lowOrder^n.lowOrder^r.lowOrder)},gamma1_32=function(e){return rotr_32(e,17)^rotr_32(e,19)^shr_32(e,10)},gamma1_64=function(e){var t=rotr_64(e,19),n=rotr_64(e,61),r=shr_64(e,6);return new Int_64(t.highOrder^n.highOrder^r.highOrder,t.lowOrder^n.lowOrder^r.lowOrder)},safeAdd_32_2=function(e,t){var n=(e&65535)+(t&65535),r=(e>>>16)+(t>>>16)+(n>>>16);return(r&65535)<<16|n&65535},safeAdd_32_4=function(e,t,n,r){var i=(e&65535)+(t&65535)+(n&65535)+(r&65535),s=(e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(i>>>16);return(s&65535)<<16|i&65535},safeAdd_32_5=function(e,t,n,r,i){var s=(e&65535)+(t&65535)+(n&65535)+(r&65535)+(i&65535),o=(e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(i>>>16)+(s>>>16);return(o&65535)<<16|s&65535},safeAdd_64_2=function(e,t){var n,r,i,s;n=(e.lowOrder&65535)+(t.lowOrder&65535);r=(e.lowOrder>>>16)+(t.lowOrder>>>16)+(n>>>16);i=(r&65535)<<16|n&65535;n=(e.highOrder&65535)+(t.highOrder&65535)+(r>>>16);r=(e.highOrder>>>16)+(t.highOrder>>>16)+(n>>>16);s=(r&65535)<<16|n&65535;return new Int_64(s,i)},safeAdd_64_4=function(e,t,n,r){var i,s,o,u;i=(e.lowOrder&65535)+(t.lowOrder&65535)+(n.lowOrder&65535)+(r.lowOrder&65535);s=(e.lowOrder>>>16)+(t.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(i>>>16);o=(s&65535)<<16|i&65535;i=(e.highOrder&65535)+(t.highOrder&65535)+(n.highOrder&65535)+(r.highOrder&65535)+(s>>>16);s=(e.highOrder>>>16)+(t.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(i>>>16);u=(s&65535)<<16|i&65535;return new Int_64(u,o)},safeAdd_64_5=function(e,t,n,r,i){var s,o,u,a;s=(e.lowOrder&65535)+(t.lowOrder&65535)+(n.lowOrder&65535)+(r.lowOrder&65535)+(i.lowOrder&65535);o=(e.lowOrder>>>16)+(t.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(i.lowOrder>>>16)+(s>>>16);u=(o&65535)<<16|s&65535;s=(e.highOrder&65535)+(t.highOrder&65535)+(n.highOrder&65535)+(r.highOrder&65535)+(i.highOrder&65535)+(o>>>16);o=(e.highOrder>>>16)+(t.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(i.highOrder>>>16)+(s>>>16);a=(o&65535)<<16|s&65535;return new Int_64(a,u)},coreSHA1=function(e,t){var n=[],r,i,s,o,u,a,f=ch_32,l=parity_32,c=maj_32,h=rotl_32,p=safeAdd_32_2,d,v,m=safeAdd_32_5,g,y=[1732584193,4023233417,2562383102,271733878,3285377520],b=[1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782];e[t>>5]|=128<<24-t%32;e[(t+65>>9<<4)+15]=t;g=e.length;for(d=0;d<g;d+=16){r=y[0];i=y[1];s=y[2];o=y[3];u=y[4];for(v=0;v<80;v+=1){if(v<16){n[v]=e[v+d]}else{n[v]=h(n[v-3]^n[v-8]^n[v-14]^n[v-16],1)}if(v<20){a=m(h(r,5),f(i,s,o),u,b[v],n[v])}else if(v<40){a=m(h(r,5),l(i,s,o),u,b[v],n[v])}else if(v<60){a=m(h(r,5),c(i,s,o),u,b[v],n[v])}else{a=m(h(r,5),l(i,s,o),u,b[v],n[v])}u=o;o=s;s=h(i,30);i=r;r=a}y[0]=p(r,y[0]);y[1]=p(i,y[1]);y[2]=p(s,y[2]);y[3]=p(o,y[3]);y[4]=p(u,y[4])}return y},coreSHA2=function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M=[],_;if(n==="SHA-224"||n==="SHA-256"){d=64;v=(t+65>>9<<4)+15;y=16;b=1;A=Number;w=safeAdd_32_2;E=safeAdd_32_4;S=safeAdd_32_5;x=gamma0_32;T=gamma1_32;N=sigma0_32;C=sigma1_32;L=maj_32;k=ch_32;O=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(n==="SHA-224"){p=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}else{p=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]}}else if(n==="SHA-384"||n==="SHA-512"){d=80;v=(t+128>>10<<5)+31;y=32;b=2;A=Int_64;w=safeAdd_64_2;E=safeAdd_64_4;S=safeAdd_64_5;x=gamma0_64;T=gamma1_64;N=sigma0_64;C=sigma1_64;L=maj_64;k=ch_64;O=[new A(1116352408,3609767458),new A(1899447441,602891725),new A(3049323471,3964484399),new A(3921009573,2173295548),new A(961987163,4081628472),new A(1508970993,3053834265),new A(2453635748,2937671579),new A(2870763221,3664609560),new A(3624381080,2734883394),new A(310598401,1164996542),new A(607225278,1323610764),new A(1426881987,3590304994),new A(1925078388,4068182383),new A(2162078206,991336113),new A(2614888103,633803317),new A(3248222580,3479774868),new A(3835390401,2666613458),new A(4022224774,944711139),new A(264347078,2341262773),new A(604807628,2007800933),new A(770255983,1495990901),new A(1249150122,1856431235),new A(1555081692,3175218132),new A(1996064986,2198950837),new A(2554220882,3999719339),new A(2821834349,766784016),new A(2952996808,2566594879),new A(3210313671,3203337956),new A(3336571891,1034457026),new A(3584528711,2466948901),new A(113926993,3758326383),new A(338241895,168717936),new A(666307205,1188179964),new A(773529912,1546045734),new A(1294757372,1522805485),new A(1396182291,2643833823),new A(1695183700,2343527390),new A(1986661051,1014477480),new A(2177026350,1206759142),new A(2456956037,344077627),new A(2730485921,1290863460),new A(2820302411,3158454273),new A(3259730800,3505952657),new A(3345764771,106217008),new A(3516065817,3606008344),new A(3600352804,1432725776),new A(4094571909,1467031594),new A(275423344,851169720),new A(430227734,3100823752),new A(506948616,1363258195),new A(659060556,3750685593),new A(883997877,3785050280),new A(958139571,3318307427),new A(1322822218,3812723403),new A(1537002063,2003034995),new A(1747873779,3602036899),new A(1955562222,1575990012),new A(2024104815,1125592928),new A(2227730452,2716904306),new A(2361852424,442776044),new A(2428436474,593698344),new A(2756734187,3733110249),new A(3204031479,2999351573),new A(3329325298,3815920427),new A(3391569614,3928383900),new A(3515267271,566280711),new A(3940187606,3454069534),new A(4118630271,4000239992),new A(116418474,1914138554),new A(174292421,2731055270),new A(289380356,3203993006),new A(460393269,320620315),new A(685471733,587496836),new A(852142971,1086792851),new A(1017036298,365543100),new A(1126000580,2618297676),new A(1288033470,3409855158),new A(1501505948,4234509866),new A(1607167915,987167468),new A(1816402316,1246189591)];if(n==="SHA-384"){p=[new A(3418070365,3238371032),new A(1654270250,914150663),new A(2438529370,812702999),new A(355462360,4144912697),new A(1731405415,4290775857),new A(41048885895,1750603025),new A(3675008525,1694076839),new A(1203062813,3204075428)]}else{p=[new A(1779033703,4089235720),new A(3144134277,2227873595),new A(1013904242,4271175723),new A(2773480762,1595750129),new A(1359893119,2917565137),new A(2600822924,725511199),new A(528734635,4215389547),new A(1541459225,327033209)]}}e[t>>5]|=128<<24-t%32;e[v]=t;_=e.length;for(m=0;m<_;m+=y){r=p[0];i=p[1];s=p[2];o=p[3];u=p[4];a=p[5];f=p[6];l=p[7];for(g=0;g<d;g+=1){if(g<16){M[g]=new A(e[g*b+m],e[g*b+m+1])}else{M[g]=E(T(M[g-2]),M[g-7],x(M[g-15]),M[g-16])}c=S(l,C(u),k(u,a,f),O[g],M[g]);h=w(N(r),L(r,i,s));l=f;f=a;a=u;u=w(o,c);o=s;s=i;i=r;r=w(c,h)}p[0]=w(r,p[0]);p[1]=w(i,p[1]);p[2]=w(s,p[2]);p[3]=w(o,p[3]);p[4]=w(u,p[4]);p[5]=w(a,p[5]);p[6]=w(f,p[6]);p[7]=w(l,p[7])}switch(n){case"SHA-224":return[p[0],p[1],p[2],p[3],p[4],p[5],p[6]];case"SHA-256":return p;case"SHA-384":return[p[0].highOrder,p[0].lowOrder,p[1].highOrder,p[1].lowOrder,p[2].highOrder,p[2].lowOrder,p[3].highOrder,p[3].lowOrder,p[4].highOrder,p[4].lowOrder,p[5].highOrder,p[5].lowOrder];case"SHA-512":return[p[0].highOrder,p[0].lowOrder,p[1].highOrder,p[1].lowOrder,p[2].highOrder,p[2].lowOrder,p[3].highOrder,p[3].lowOrder,p[4].highOrder,p[4].lowOrder,p[5].highOrder,p[5].lowOrder,p[6].highOrder,p[6].lowOrder,p[7].highOrder,p[7].lowOrder];default:return[]}},jsSHA=function(e,t){this.sha1=null;this.sha224=null;this.sha256=null;this.sha384=null;this.sha512=null;this.strBinLen=null;this.strToHash=null;if("HEX"===t){if(0!==e.length%2){return"TEXT MUST BE IN BYTE INCREMENTS"}this.strBinLen=e.length*4;this.strToHash=hex2binb(e)}else if("ASCII"===t||"undefined"===typeof t){this.strBinLen=e.length*charSize;this.strToHash=str2binb(e)}else{return"UNKNOWN TEXT INPUT TYPE"}};jsSHA.prototype={getHash:function(e,t){var n=null,r=this.strToHash.slice();switch(t){case"HEX":n=binb2hex;break;case"B64":n=binb2b64;break;default:return"FORMAT NOT RECOGNIZED"}switch(e){case"SHA-1":if(null===this.sha1){this.sha1=coreSHA1(r,this.strBinLen)}return n(this.sha1);case"SHA-224":if(null===this.sha224){this.sha224=coreSHA2(r,this.strBinLen,e)}return n(this.sha224);case"SHA-256":if(null===this.sha256){this.sha256=coreSHA2(r,this.strBinLen,e)}return n(this.sha256);case"SHA-384":if(null===this.sha384){this.sha384=coreSHA2(r,this.strBinLen,e)}return n(this.sha384);case"SHA-512":if(null===this.sha512){this.sha512=coreSHA2(r,this.strBinLen,e)}return n(this.sha512);default:return"HASH NOT RECOGNIZED"}},getHMAC:function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p=[],d=[];switch(r){case"HEX":i=binb2hex;break;case"B64":i=binb2b64;break;default:return"FORMAT NOT RECOGNIZED"}switch(n){case"SHA-1":o=64;h=160;break;case"SHA-224":o=64;h=224;break;case"SHA-256":o=64;h=256;break;case"SHA-384":o=128;h=384;break;case"SHA-512":o=128;h=512;break;default:return"HASH NOT RECOGNIZED"}if("HEX"===t){if(0!==e.length%2){return"KEY MUST BE IN BYTE INCREMENTS"}s=hex2binb(e);c=e.length*4}else if("ASCII"===t){s=str2binb(e);c=e.length*charSize}else{return"UNKNOWN KEY INPUT TYPE"}u=o*8;l=o/4-1;if(o<c/8){if("SHA-1"===n){s=coreSHA1(s,c)}else{s=coreSHA2(s,c,n)}s[l]&=4294967040}else if(o>c/8){s[l]&=4294967040}for(a=0;a<=l;a+=1){p[a]=s[a]^909522486;d[a]=s[a]^1549556828}if("SHA-1"===n){f=coreSHA1(p.concat(this.strToHash),u+this.strBinLen);f=coreSHA1(d.concat(f),u+h)}else{f=coreSHA2(p.concat(this.strToHash),u+this.strBinLen,n);f=coreSHA2(d.concat(f),u+h,n)}return i(f)}};window.jsSHA=jsSHA